# はじめに・初期設定ガイド

## TaskAppとは

TaskAppは、制作会社・開発会社がクライアントとのプロジェクト管理を効率化するためのシステムです。

### 主な特徴

| 特徴 | 説明 |
|------|------|
| ボール所有 | 「次に誰がアクションするか」を明確にする仕組み。タスクごとに `社内` または `クライアント` のどちらにボールがあるかを表示 |
| 監査グレードの意思決定追跡 | 誰が・いつ・どの会議で決定したかを自動記録。仕様決定の証跡を完全に残す |
| クライアントポータル | クライアント専用の画面を提供。アカウント作成不要のトークンベース認証 |
| 3ペインレイアウト | 左ナビ(240px) + メイン(flex) + インスペクター(400px) の固定レイアウト |

### データモデルの基本

タスクには以下の概念があります。

| 項目 | 値 | 意味 |
|------|-----|------|
| **ball** | `client` / `internal` | 次にアクションすべき側 |
| **origin** | `client` / `internal` | タスクを起票した側 |
| **type** | `task` / `spec` | spec は仕様決定タスク（spec_path と decision_state が必須） |

---

## アカウント作成

### 手順

1. ブラウザで TaskApp のログインページ (`/login`) にアクセスする
2. 「アカウントをお持ちでない方」のリンクをクリックし、新規登録ページ (`/signup`) に移動する
3. 以下の情報を入力する
   - **組織名**: 自社の名前（例: 「株式会社サンプル」）
   - **メールアドレス**: ログインに使用するメールアドレス
   - **パスワード**: 8文字以上の安全なパスワード
4. 「アカウント作成」ボタンをクリックする
5. 入力したメールアドレスに確認メールが届くので、メール内のリンクをクリックして認証を完了する

> **注意**: 新規登録すると自動的に Free プランが適用されます。Free プランの制限は以下のとおりです。
> - プロジェクト: 5件
> - 社内メンバー: 5名
> - クライアント: 5名
> - ストレージ: 100MB

---

## ログイン方法

### 手順

1. ログインページ (`/login`) にアクセスする
2. 登録済みのメールアドレスとパスワードを入力する
3. 「ログイン」ボタンをクリックする
4. ログイン成功後、最後に開いていたプロジェクト画面にリダイレクトされる

### パスワードを忘れた場合

1. ログインページで「パスワードを忘れた方」のリンクをクリックする
2. パスワードリセットページ (`/reset`) で登録メールアドレスを入力する
3. 「リセットメールを送信」をクリックする
4. メール内のリンクからパスワード再設定ページ (`/reset/confirm`) にアクセスする
5. 新しいパスワードを入力して再設定を完了する

---

## 組織（Organization）の作成

組織は、新規登録時に自動的に作成されます。登録者は自動的にその組織の **owner** ロールになります。

> **Tips**: 組織は会社単位で1つ作成することを推奨します。複数のクライアントプロジェクトは、1つの組織内に複数のプロジェクト（Space）として管理できます。

---

## プロジェクト（Space）の作成

プロジェクトは「Space」とも呼ばれ、クライアント案件ごとに作成します。

### 手順

1. 左ナビゲーションでプロジェクト一覧を開く
2. 「新規プロジェクト」ボタンをクリックする
3. プロジェクト名を入力する（例: 「A社 Webサイトリニューアル」）
4. 作成を確定する

> **注意**: Free プランではプロジェクト数の上限が5件です。上限に達した場合はプランのアップグレードを検討してください。

---

## メンバーの招待

### 社内メンバーの招待

社内メンバーとは、自社のチームメンバー（ディレクター、デザイナー、エンジニアなど）を指します。

#### 手順

1. プロジェクトの設定ページを開く（左ナビ > 設定アイコン）
2. 「メンバー」セクションを表示する
3. 招待フォームにメールアドレスを入力する
4. ロールを選択する
5. 「招待」ボタンをクリックする
6. 招待メールが送信される

#### ロール一覧

| ロール | 権限 |
|--------|------|
| **admin** | フルアクセス。メンバー招待、設定変更、タスク・会議の全操作が可能 |
| **member** | タスク・会議の操作が可能。メンバー招待や設定変更は不可 |

> **Tips**: 招待メールには組織名とプロジェクト名が含まれます。受信者はメール内のリンクからパスワードを設定して参加できます。

### 招待の受諾（社内メンバー）

- **新規ユーザーの場合**: メール内のリンク (`/invite/:token`) からパスワードを設定してアカウントを作成
- **既存ユーザーの場合**: ログイン済みであれば自動的にプロジェクトに追加される。未ログインの場合はログイン後に追加される

> **注意**: 上記は社内メンバー（admin / member）の場合です。クライアントの招待は[クライアントの招待](#クライアントの招待)セクションを参照してください。

---

## 権限とロールの詳細

TaskApp には **組織レベル** と **プロジェクト（スペース）レベル** の2層の権限があります。

### 組織レベルのロール

組織（Organization）は最上位の単位です。新規登録時に自動作成され、登録者が `owner` になります。

| ロール | 説明 |
|--------|------|
| **owner** | 組織の所有者。全権限を持つ。1組織につき1名 |
| **member** | 組織の内部メンバー（開発スタッフ） |
| **client** | クライアント（発注者側の担当者） |

### プロジェクト（スペース）レベルのロール

各プロジェクト（Space）ごとにメンバーシップとロールが設定されます。

| ロール | 説明 |
|--------|------|
| **admin** | プロジェクト管理者。設定変更、メンバー招待が可能 |
| **member** | プロジェクトメンバー。タスク・会議の操作が可能 |
| **client** | クライアントメンバー。ポータル経由で閲覧・コメント |

### 機能別の権限マトリクス

#### タスク操作

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| タスク一覧の閲覧 | ✅ | ✅ | ✅ | ✅（ポータル経由） |
| タスクの作成 | ✅ | ✅ | ✅ | ❌ |
| タスクの編集（タイトル、説明、期限等） | ✅ | ✅ | ✅ | ❌ |
| ステータスの変更 | ✅ | ✅ | ✅ | ❌ |
| ボールの移動（ball_pass） | ✅ | ✅ | ✅ | ❌ |
| タスクの削除 | ✅ | ✅ | ❌ | ❌ |
| 担当者（assignee）の変更 | ✅ | ✅ | ✅ | ❌ |
| 責任者（owners）の変更 | ✅ | ✅ | ✅ | ❌ |
| コメントの追加 | ✅ | ✅ | ✅ | ✅ |

#### 会議操作

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| 会議の作成 | ✅ | ✅ | ✅ | ❌ |
| 会議の開始・終了 | ✅ | ✅ | ✅ | ❌ |
| 議事録の記入 | ✅ | ✅ | ✅ | ❌ |
| 会議一覧の閲覧 | ✅ | ✅ | ✅ | ✅（ポータル経由） |
| 決定事項の確認（承認） | ✅ | ✅ | ✅ | ✅ |

#### レビュー操作

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| レビューの開始（review_open） | ✅ | ✅ | ✅ | ❌ |
| レビューの承認（review_approve） | ✅ | ✅ | ✅ | ✅（レビュアー指定時） |
| 変更依頼（review_block） | ✅ | ✅ | ✅ | ✅（レビュアー指定時） |
| レビュー一覧の閲覧 | ✅ | ✅ | ✅ | ✅（ポータル経由） |

#### 日程調整操作

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| 日程提案の作成 | ✅ | ✅ | ✅ | ❌ |
| 日程への回答 | ✅ | ✅ | ✅ | ✅ |
| 日程の確定 | ✅ | ✅ | ✅ | ❌ |

#### プロジェクト設定

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| プロジェクト名変更 | ✅ | ✅ | ❌ | ❌ |
| メンバー招待 | ✅ | ✅ | ❌ | ❌ |
| メンバー削除 | ✅ | ✅ | ❌ | ❌ |
| ロール変更 | ✅ | ✅ | ❌ | ❌ |
| 外部連携設定（Slack、Google Calendar等） | ✅ | ✅ | ❌ | ❌ |
| APIキー管理 | ✅ | ✅ | ❌ | ❌ |
| データエクスポート | ✅ | ✅ | ✅ | ❌ |
| マイルストーン管理 | ✅ | ✅ | ❌ | ❌ |
| 設定の閲覧 | ✅ | ✅ | ✅ | ❌ |

#### 組織管理

| 操作 | owner | admin | member | client |
|------|-------|-------|--------|--------|
| プロジェクト作成 | ✅ | ✅ | ❌ | ❌ |
| 組織設定変更 | ✅ | ❌ | ❌ | ❌ |
| プラン管理・課金 | ✅ | ❌ | ❌ | ❌ |

### クライアントに見えるデータ / 見えないデータ

クライアントポータルでは、セキュリティのため一部の情報がフィルタリングされます。

#### クライアントに表示される情報

- タスクのタイトル、説明、ステータス、期限
- コメント・ディスカッション
- 仕様決定の内容（decision_state）
- レビューの承認状態
- マイルストーン・進捗
- 会議の予定・決定事項

#### クライアントに非表示の情報

- GitHub Issue / PR リンク
- 内部専用ラベル
- 技術的なID（TPE等）
- 内部メンバーの詳細名（汎用表示）
- コスト・請求関連メタデータ
- 内部コメント（internal フラグ付き）

### プラン別の制限

| リソース | Free | Pro | Enterprise |
|---------|------|-----|------------|
| プロジェクト数 | 5 | 20 | 無制限 |
| 社内メンバー数 | 5 | 20 | 無制限 |
| クライアント数 | 5 | 20 | 無制限 |
| ストレージ | 100MB | 5GB | 無制限 |

> **注意**: 制限に達すると、新規作成や招待ができなくなります。プランのアップグレードが必要です。制限状況はプロジェクト設定画面で確認できます。

---

## クライアントの招待

クライアントは、発注者側の担当者を指します。TaskApp ではクライアント専用のポータル画面が提供されます。

### 特徴

| 項目 | 内容 |
|------|------|
| 認証方式 | トークンベース認証（TaskApp のアカウント作成が不要） |
| 招待の有効期限 | 30日間 |
| アクセス先 | クライアントポータル (`/portal`) |
| 権限 | タスクの閲覧、コメント、レビュー承認 |

### 手順

1. プロジェクトの設定ページを開く
2. 「メンバー」セクションの招待フォームで、ロールに `client` を選択する
3. クライアント担当者のメールアドレスを入力する
4. 「招待」ボタンをクリックする
5. クライアントに招待メールが送信される

### クライアント側の参加フロー

1. 招待メールを受信する
2. メール内のリンク (`/portal/:token`) をクリックする
3. クライアントポータルにアクセスできるようになる

> **注意**: クライアントはパスワードの設定やアカウント作成は不要です。招待リンクからそのままポータルにアクセスできます（トークンベース認証）。招待リンクの有効期限は30日間です。期限切れの場合は再度招待を送信してください。

---

## 招待権限

招待を送信できるのは以下のロールのみです。

| ロール | 招待可否 |
|--------|----------|
| 組織の owner | 可能 |
| スペースの admin | 可能 |
| member | 不可 |
| client | 不可 |

---

## 初期設定チェックリスト

TaskApp を使い始める際に、以下の順番で設定を進めてください。

### ステップ一覧

| No. | ステップ | 説明 | 必須 |
|-----|---------|------|------|
| 1 | 組織作成 | 新規登録時に自動作成される | 自動 |
| 2 | プロジェクト作成 | クライアント案件ごとに1つ作成 | 必須 |
| 3 | 社内メンバー招待 | チームメンバーをプロジェクトに追加 | 必須 |
| 4 | クライアント招待 | クライアント担当者を招待 | 必須 |
| 5 | マイルストーン設定 | プロジェクトのフェーズを定義 | 推奨 |
| 6 | 最初のタスク作成 | プロジェクトの作業を登録開始 | 必須 |

### 1. 組織作成（自動）

新規登録で完了済みです。

### 2. プロジェクト作成

1. ログイン後、左ナビから「新規プロジェクト」を選択
2. プロジェクト名を入力して作成

### 3. 社内メンバー招待

1. 設定 > メンバーセクションを開く
2. メンバーのメールアドレスを入力して招待

### 4. クライアント招待

1. 設定 > メンバーセクションで、ロール `client` で招待
2. クライアント担当者のメールアドレスを入力して送信

### 5. マイルストーン設定

1. 設定 > マイルストーンセクションを開く
2. プロジェクトのフェーズ（例: 「要件定義」「設計」「開発」「テスト」）を登録
3. 各マイルストーンに期限を設定

> **Tips**: マイルストーンを設定すると、タスクをフェーズごとに整理でき、ガントチャートでの進捗確認も可能になります。

### 6. 最初のタスク作成

1. タスク一覧画面で「新規タスク」ボタンをクリック
2. タスク名、担当者、期限などを入力
3. ボール（`社内` または `クライアント`）を設定

> **Tips**: ボールの設定は重要です。「次に誰がアクションすべきか」を明確にすることで、タスクの停滞を防ぎます。

---

## 画面構成の基本

TaskApp の画面は3ペイン固定レイアウトです。

```
┌──────────┬─────────────────────────┬────────────────┐
│          │                         │                │
│ 左ナビ    │      メインエリア        │  インスペクター  │
│ (240px)  │      (flex-1)           │   (400px)      │
│          │                         │                │
│ ・タスク   │  タスク一覧/会議一覧     │  タスク詳細     │
│ ・会議    │  Wiki など              │  会議詳細       │
│ ・Wiki   │                         │                │
│ ・設定    │                         │                │
│          │                         │                │
└──────────┴─────────────────────────┴────────────────┘
```

> **注意**: インスペクターはメインエリアに重ならず、常に並列表示されます。モーダルダイアログではなく、右ペインでの詳細表示が基本です。

---

## 次のステップ

初期設定が完了したら、以下のマニュアルを参照して各機能の使い方を確認してください。

- [タスク管理](./tasks.md) - タスクの作成、編集、ボール管理
- [会議管理](./meetings.md) - 会議の作成、議事録、仕様決定
- [レビュー・承認](./reviews.md) - レビューワークフロー
- [日程調整](./scheduling.md) - 候補日の提案と確定
- [プロジェクト設定](./settings.md) - メンバー管理、外部連携
- [Wiki](./wiki.md) - ナレッジベースの活用
